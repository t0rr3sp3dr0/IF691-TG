\section{Conclusion}
\label{section:conclusion}

The certification programs developed by the \gls{wifi} Alliance have successfully ensured interoperability between devices and have set a minimal level of security on the certified devices. But when flaws were discovered on some authentication or encryption mechanism, the interoperability and security goals conflicted and the solutions proposed were controversial. The superseding standards tried to maintain a compatibility layer with the previous protocol that showed to cause security problems.

All the assessed \glspl{cpe} fulfill their job as a plug'n'play solution that provides access to all services acquired from the \gls{isp} without requiring customer intervention. But the different pieces of equipment provide their frictionless experience with different levels of security. Some come configured with settings that increase interoperability while others focus on security.

Although there was no evidence that the \glspl{cpe} proactively forward information about the local network and devices connected to it, anyone who accesses their \gls{http} Management Interface is able to gather the information without authenticating, including the customer phone number and the device's \gls{gpon} \gls{s/n}. The situation is aggravated in \glspl{cpe} 2 and 3, as they allow the management interfaces to be accessed from \gls{wan}.

Problems like the use of old security standard and weak passwords could be easily mitigated by changing the default configurations set by the \gls{isp}. But sometimes it is not as easy as it should be, some settings are purposely hidden from the consumer management interface and are only accessible when signing in with the support user in an unindexed page. Even worse, on \glspl{cpe} 0 and 1, the support management interface is incomplete and some settings can only be changed by exporting the configuration file, modifying its content, and finally importing the file back to the device. On \gls{cpe} 5, the configuration file also needs to be decrypted after download and encrypted before upload.

But flaws in the implementation of management interfaces of some devices pose a serious threat to the security and privacy of consumers, these can only be patched with a firmware upgrade. \glspl{cpe} 0 and 1 donâ€™t rely on cookies and/or tokens to maintain the user session on the \gls{http} Management Interface, instead, any request reaching the interface from an specific \gls{ip} is considered authenticated after a user logs in. Even worse, these \glspl{cpe} don't support firmware upgrades, so the problems are unfixable. But the most concerning problem is the unauthenticated configuration import of \gls{cpe} 5, making null and void almost any kind of security measure the device has in place, as any configuration can be overwritten by anyone able to send requests to its \gls{http} Management Interface.

The act of remote managing of \glspl{cpe} by the \gls{isp} is not a problem by itself. But the connection with the \gls{isp} \gls{acs} is not encrypted and may be tampered with. Connections to the file server that hosts the firmware images for the \gls{isp} \glspl{cpe} are also not encrypted and pose a similar threat. Unfortunately there is no way to reconfigure \gls{cwmp} in a more secure fashion, as the \gls{isp} unreasonably downgrades the connection of \glspl{cpe} using \glspl{http} to \gls{http}. The only approach to the problem would be to disable \gls{cwmp} completely.

Out of the customer control, the \gls{sip} server of the \gls{isp} should use \gls{tls} even if the traffic doesn't go through the broadband network; the password should be more complex and be completely random, not following any pattern; the origin of registration requests should be verified and only the customer that owns the telephone number should be able to authenticate with it; and mechanisms to decrease the feasibility of online brute-force attacks should be placed.

Using a \gls{crg} as replacement for \glspl{cpe} proved to be possible and Internet configuration is straightforward. Although the \gls{voip} configuration may be troublesome, it is feasible to make it work reliably. It is important to notice that while the \gls{crg} allows customers to freely configure the device and not have to rely on the \gls{isp} anymore, it also makes the consumer responsible for properly maintaining the device. If a \gls{crg} is not properly configured and regularly updated, it might not be better than an out-of-the-box \gls{cpe}.

Regardless of the device used as a residential gateway, there are some recommendations that the customer should follow to improve the security of its residencial network. Changing the default passwords of the management interfaces and wireless networks is a must do, strong passwords should be used. The use of \gls{wps} is disencourage and should be disabled. If the wireless devices connected to the network support newer security protocols, interoperability with old standards should be disabled on the residential gateway. Management interfaces must not be accessible via \gls{wan} and, if not used, non-\gls{http} interfaces should be completely disabled. Finally, it is important to keep all devices on the network up to date, not only the residential gateway.
